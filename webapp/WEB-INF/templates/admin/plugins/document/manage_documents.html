<div class="row">
	<div class="span3 well">
            <fieldset>
                <legend>#i18n{document.manage_documents.labelSpaces}</legend>
                ${spaces_tree}
                <#if space_actions_list?size != 0 >
            </fieldset>
            <fieldset>
                <legend>#i18n{document.manage_documents.labelActions}</legend>

                <#list space_actions_list as space_action>
                <a href="${space_action.url}?id_space=${space.id}" alt="${space_action.description}" title="${space_action.description}" class="btn btn-mini btn-primary">
					<i class="${space_action.iconUrl} icon-white"></i></a>
                </#list>
                </#if>
            </fieldset>
        </div>
        <div class="span8">
            <#if space?has_content >
            <#if space.documentCreationAllowed >
            <#if document_types_list?has_content >
            <div class="well well-small">
                <form class="form-inline pull-right" method="post" name="SearchDocumentById" action="jsp/admin/plugins/document/DoSearchDocumentById.jsp">
                    <input type="text" name="id_document" class="input-xlarge"  maxlength="10" />
                    <button class="btn btn-primary" type="submit" ><i class="icon-search icon-white"></i><!--&nbsp;#i18n{document.manage_documents.buttonSearch}--></button>
					<p class="help-block">#i18n{document.manage_documents.labelSearchById}</p>
                </form>
                <form class="form-inline" method="post" name="FullTextSearchDocument" action="jsp/admin/plugins/document/DocumentSearch.jsp">
                    <input type="text" name="query" class="input-xlarge" maxlength="50" />
                    <button class="btn btn-primary" type="submit" ><i class="icon-search icon-white"></i><!--&nbsp;#i18n{document.manage_documents.buttonSearch}--></button>
					<p class="help-block">#i18n{document.manage_documents.labelFullTextSearch}</p>
                </form>
            </div>
            </#if>
            </#if>
            <fieldset>
                <legend>#i18n{document.manage_documents.listTitle}
                    <#if space.documentCreationAllowed >
                    <#if document_types_list?has_content >
                    <form class="form-inline pull-right" method="post" name="CreateDocument" action="jsp/admin/plugins/document/CreateDocument.jsp" >
                        <!--#i18n{document.manage_documents.labelCreate} :-->
                        <@combo name="document_type_code" default_value="" items=document_types_list />
                        <button class="btn btn-primary" type="submit" ><i class="icon-plus icon-white"></i>&nbsp;#i18n{document.manage_documents.buttonCreate}</button>
                    </form>
                    </#if>
                    </#if>
                </legend>
                <#if document_types_filter_list?size &gt; 1 >
                <form class="form-search" method="post" name="FilterDocumentsForm" action="jsp/admin/plugins/document/ManageDocuments.jsp">
                    <label>#i18n{document.manage_documents.labelType} :</label>
                    <@combo name="document_type_code_filter" default_value="${default_document_type}" items=document_types_filter_list />
                    <label>#i18n{document.manage_documents.labelState} :</label>
                    <@combo name="id_state_filter" default_value="${default_state}" items=states_filter_list />
                    <button class="btn btn-primary" type="submit" ><i class="icon-filter icon-white"></i>&nbsp;#i18n{document.manage_documents.buttonFilter}</button>
                </form>
            </fieldset>
            <#if documents_list?size = 0 >
            <fieldset>
                <legend>#i18n{document.manage_documents.noDocument}</legend>
                <#else>
                <form class="form-inline"  method="post" action="jsp/admin/plugins/document/ManageDocuments.jsp">
                    <label>#i18n{document.manage_documents.labelViewType} :</label>
                    <@combo name="view_type" default_value="${view_type}" items=view_types_list />
                    <button class="btn btn-primary" type="submit" ><i class="icon-ok icon-white"></i></button>
                </form>
            </fieldset>
			 <p>
                <select id="selection" name="selection">
                            <option value="validate">#i18n{document.manage_document.validate}</option>
                            <option value="submit">#i18n{document.manage_document.submit}</option>
                            <option value="refuse">#i18n{document.manage_document.refuse}</option>
                            <option value="remove">#i18n{document.manage_document.remove}</option>
                            <option value="archive">#i18n{document.manage_document.archive}</option>
                            <option value="unarchive">#i18n{document.manage_document.unarchive}</option>
                        </select>
                        <button class="btn btn-primary" type="submit" ><i class="icon-ok icon-white"></i>&nbsp;#i18n{document.manage_documents.applyToSelection}</button>					
                </p>
            <#if view_type = "detail" >
            <form class="form-horizontal" id="documents_form" name="documents_form" method="post" action="jsp/admin/plugins/document/DoActionSelectionDocument.jsp">
                <table class="table table-striped table-condensed">
                    <tr>
                        <th><input id="select_all" name="select_all" type="checkbox" /></th>
                        <th>#i18n{document.manage_documents.labelDocument}</th>
                        <th>#i18n{document.manage_documents.labelPublishedStatus}<@sort jsp_url="jsp/admin/plugins/document/ManageDocuments.jsp" attribute="publishedStatus" /></th>
                        <th>#i18n{document.manage_documents.labelActions}</th>
                    </tr>
                    <#list documents_list as document >
                    <tr>
                        <td>
                            <input id="document_selection" name="document_selection" type="checkbox" value="${document.id}" />
                        </td>
                        <td>

                            <p><img src="${document.thumbnail}" alt="${document.title}" title="${document.title} - ${document.type}" class="thumblist" />${document.id} - ${document.title}</p>
                            <#if document.comment != ""> <p class="label label-warning">${document.comment}</p></#if>
                            <p>#i18n{document.manage_documents.labelState} : <strong>${document.state}</strong> | ${document.dateModification}</p>
                        </td>
                        <td>
                            <#if document.publishedStatus = 0> 
                            <span class="label label-success"><i class="icon-ok-sign icon-white"></i> #i18n{document.manage_documents.PublishedStatus}</span>
                            <#else>
                            <span class="label label-important"><i class="icon-remove-sign icon-white"></i> #i18n{document.manage_documents.UnPublishedStatus}</span>
                            </#if>
                        </td>
                        <td>
                            <#list document.actions?reverse  as action >
                            <#if action.url?has_content>
                            <a class="btn btn-mini <#if action.idAction==1 || action.idAction==6>btn-danger<#elseif action.idAction==4 || action.idAction==12>btn-success<#else>btn-primary</#if>" href="${action.url}id_document=${document.id}&id_action=${action.idAction}" title="${action.description}" >
                                <i class="${action.iconUrl} icon-white"></i>
                            </a>
                            </#if>  
                            </#list>
                        </td>
                    </tr>
                    </#list>
                </table>
                <p>
                <select id="selection" name="selection">
                            <option value="validate">#i18n{document.manage_document.validate}</option>
                            <option value="submit">#i18n{document.manage_document.submit}</option>
                            <option value="refuse">#i18n{document.manage_document.refuse}</option>
                            <option value="remove">#i18n{document.manage_document.remove}</option>
                            <option value="archive">#i18n{document.manage_document.archive}</option>
                            <option value="unarchive">#i18n{document.manage_document.unarchive}</option>
                        </select>
                        <button class="btn btn-primary" type="submit" ><i class="icon-ok icon-white"></i>&nbsp;#i18n{document.manage_documents.applyToSelection}</button>					
                </p>
            </form>
            </fieldset> 
            </#if>

            <#if view_type = "thumbnail">
            <ul class="thumbnails">
                <#list documents_list as document >
                <li class="span4">
                    <div class="thumbnail">
                        <img src="${document.thumbnail}" alt="${document.title}" title="${document.title}" />
                        <div class="caption">
                            <h4><#if document.title?length &gt; 18>${document.title?substring(0,18)}...<#else>${document.title}</#if>- <small>${document.id}</small></h4>
                            <p>${document.type}</p>
                            <p>
                                <#list document.actions?sort_by("idAction") as action >
                                <#if action.url?has_content>
                                <a href="${action.url}id_document=${document.id}&id_action=${action.idAction}" title="${action.description}" >
                                    <i class="${action.iconUrl}"></i>
                                </a>
                                </#if>
                                </#list>
                            </p>
                        </div>
                    </div>
                </li>
                </#list>
            </ul>
            </#if>

            <@paginationAdmin paginator=paginator combo=1 />

            </#if>
            <#else>
            <#if child_spaces_list?size != 0 >
            <fieldset>
                <legend>#i18n{document.manage_documents.childSpacesList} :</legend>
                <ul class="unstyled">
                    <#list child_spaces_list as child_space>
                    <li>
                        <h4>
                            <a href="jsp/admin/plugins/document/ManageDocuments.jsp?id_space_filter=${child_space.id}" >
                                <img src="${child_space.iconUrl}" alt="${child_space.description}" title="${child_space.description}" />&nbsp;${child_space.name} <small>${child_space.description}</small>
                            </a>
                        </h4>
                    </li>
                    </#list>
                </ul>
                </#if>
                </#if>
                </#if>
            </fieldset>
    </div>
</div>
<script src="js/jquery/plugins/ui/jstree/jquery.jstree.js"></script>
<script src="js/jquery/plugins/ui/jstree/jquery.cookie.js"></script>
<script type="text/javascript"> 
    jQuery(function($) {
        // Set space_id
        var spaceid = ${space.id};
        // Get space_id from url parameter
        var loc = location.search;
        if ( spaceid != loc ) {
            if ( loc.indexOf("id_space_filter") > 0 ){ 
                // Set space_id from url parameter if exists
                spaceid =  loc.slice( loc.lastIndexOf("=") + 1 );
            } 
        }

        // Set the cookie of jstree
        $.cookie("jstree_select", "#node-" + spaceid );
        $("#tree").jstree({
            "ui" : {
                "select_limit" : 1,
            },
            "themes" : {
                "theme" : "default",
                "icons" : false
            },
            "cookies" : {
                "save_opened" : false,
            },
            "core" : { "initially_open" : [ "node-0" ] },
            "plugins" : [ "themes", "html_data", "cookies", "ui" ]
        });
    });

    $("#select_all").click( function(){                    
        $("input[type='checkbox']").attr('checked',  this.checked);
    });
</script> 
